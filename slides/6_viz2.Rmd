
---
title: "Visualization"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      
   

---
class: inverse, middle, center

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(message = FALSE)
```

```{r xaringan-tile-view, echo=FALSE}
xaringanExtra::use_tile_view()
```


```{r xaringan-panelset, echo=FALSE}
xaringanExtra::use_panelset()
```

```{r, echo=FALSE}
xaringanExtra::use_webcam()
```

```{r xaringan-fit-screen, echo=FALSE}
xaringanExtra::use_fit_screen()


```

```{r, echo=FALSE, message=FALSE}
library(tidyverse)
library(knitr)    # For knitting document and include_graphics function
df <- read_csv('https://covidtracking.com/data/download/all-states-history.csv')

df <- df %>% filter(deathIncrease>0, positiveIncrease>0)

df <- df %>% drop_na(dataQualityGrade)

names(df)[c(3, 6, 24)] <- c('data_qual','d_in', 'pos_in')

library(lubridate)

df$month <- month(df$date, label = TRUE)

df$day <- wday(df$date)
df$day_type <- case_when(df$day < 6 ~ 'weekday',
                         TRUE~'weekend')

```
---
class: inverse, middle, center
# Combine multiple graphs with the same aes
---
```{r, fig.height=6}
df %>% ggplot()+ 
  geom_point(mapping=aes(x=pos_in, y=d_in, color=month))+
  geom_smooth(mapping=aes(x=pos_in, y=d_in, color=month))
```
---
```{r, fig.height=6}
df %>% ggplot(mapping=aes(x=pos_in, y=d_in, color=month))+ 
  geom_point()+
  geom_smooth()
```
---
class: inverse, middle, center
# Facets
---
```{r, fig.height=6}
df %>% filter(month=='Apr'|month=='Jul') %>% 
  ggplot(mapping=aes(x=pos_in, y=d_in))+ 
  geom_point()+
  geom_smooth()+
  facet_wrap(~month)
```

---
```{r, fig.height=6}
df %>% filter(month=='Apr'|month=='Jul') %>% 
  ggplot(mapping=aes(x=pos_in, y=d_in, color=month))+ 
  geom_point()+
  geom_smooth()+
  facet_wrap(month~day_type)
```
---
class: inverse, middle, center
# Position adjustments
---
```{r, fig.height=6}
df %>% filter(state=='RI', month=='Aug') %>% ggplot()+ 
  geom_point(mapping=aes(x=pos_in, y=d_in, color=day_type))
```
---
```{r, fig.height=6}
df %>% filter(state=='RI', month=='Aug') %>% ggplot()+ 
  geom_point(mapping=aes(x=pos_in, y=d_in, color=day_type), 
             position='jitter')
```
---

```{r, fig.height=6}
df %>% filter(state=='RI') %>% ggplot()+ 
  geom_bar(mapping=aes(x=data_qual, fill=day_type), 
           position = 'dodge')
```
---
```{r, fig.height=6}
df %>% filter(state=='RI') %>% ggplot()+ 
  geom_bar(mapping=aes(x=data_qual, fill=day_type), 
           position = 'fill')
```
---
class: inverse, middle, center

# geom_bar vs. geom_col
---
**geom_bar**
```{r, fig.height=6}
df %>% ggplot()+ 
  geom_bar(mapping=aes(x=data_qual))
```

---
**geom_col**
```{r, fig.height=6}
df %>% group_by(data_qual) %>% summarise(mean=mean(pos_in)) %>% 
  ggplot()+ 
  geom_col(mapping=aes(x=data_qual, y=mean))
```
---
class: inverse, middle, center
# Labels/Title

---
```{r, fig.height=6, eval=FALSE}
df %>% filter(month=='Apr'|month=='Sep') %>% 
  ggplot()+ 
  geom_point(mapping=aes(x=pos_in, y=d_in, color=month))+
  labs(x='Number of Positive Case', 
       y = 'Number of Death', 
       color='Month of the Year', 
       title = 'Scatter Plot of Positive Cases and Deaths', 
       caption = 'April appears to be more deadly than September.')
```

---
```{r, echo=FALSE}
df %>% filter(month=='Apr'|month=='Sep') %>% 
  ggplot()+ 
  geom_point(mapping=aes(x=pos_in, y=d_in, color=month))+
  labs(x='Number of Positive Case', y = 'Number of Death', color='Month of the Year', title = 'Scatter Plot of Positive Cases and Deaths', caption = 'April appears to be more deadly than September.')
```

---
```{r, fig.height=6}
df %>% filter(month=='Sep') %>% 
  ggplot()+ 
  geom_point(mapping=aes(x=pos_in, y=d_in))+
  facet_wrap(month~data_qual)+
  labs(x='Number of  Positive Case', y='Number of  Death')
```
---
```{r, fig.height=6}
df %>% filter(month=='Sep') %>% 
  ggplot()+ 
  labs(x='Number of  Positive Case', y='Number of  Death')+
  geom_point(mapping=aes(x=pos_in, y=d_in))
```

---
class: inverse, middle, center

# Change Themes

---
```{r, fig.height=6}
df %>% filter(month=='Apr'|month=='Jul') %>% 
  ggplot(mapping=aes(x=pos_in, y=d_in, color=month))+ 
  geom_point()+
  geom_smooth()+
  facet_wrap(month~day_type)
```

---
```{r, fig.height=6}
df %>% filter(month=='Apr'|month=='Jul') %>% 
  ggplot(mapping=aes(x=pos_in, y=d_in, color=month))+ 
  geom_point()+
  geom_smooth()+
  facet_wrap(month~day_type)+
  theme_dark()
```

---
```{r, fig.height=6}
df %>% filter(month=='Apr'|month=='Jul') %>% 
  ggplot(mapping=aes(x=pos_in, y=d_in, color=month))+ 
  geom_point()+
  geom_smooth()+
  facet_wrap(month~day_type)+
  theme_linedraw()
```
---
# More Themes

- https://ggplot2.tidyverse.org/reference/ggtheme.html

---
**`ggthemes` package**

```{r, fig.height=6}
library(ggthemes)
df %>% filter(month=='Apr'|month=='Jul') %>% 
  ggplot(mapping=aes(x=pos_in, y=d_in, color=month))+ 
  geom_point()+geom_smooth()+facet_wrap(month~day_type)+
  scale_color_stata()
```

---
**Save plots**
```{r, fig.height=6}
df %>% group_by(data_qual) %>% summarise(mean=mean(pos_in)) %>% 
  ggplot()+ 
  geom_col(mapping=aes(x=data_qual, y=mean)) +
  ggsave('abc.png')+ggsave('abc.pdf')
```
